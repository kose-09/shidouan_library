<h1>投稿詳細</h1>

<table>
  <tbody>
      <tr>
        <th>題材名</th>
        <td><%= @post.title %></td>
      </tr>
      <tr>
        <th></th>
        <td>
          <embed src="<%= polymorphic_url(@post.shidouan_pdf) %>" width="700" height="700" type="application/pdf"></embed>
        </td>
      </tr>
      <tr>
        <th>説明文</th>
        <td><%= @post.caption %></td>
      </tr>
      <tr>
        <% if @post.user == current_user %>
          <td><%= link_to "edit", edit_post_path(@post.id) %></td>
          <td><%= link_to "destroy", post_path(@post.id), method: :delete, data: {confirm: "本当に削除しますか？"} %></td>
        <% end %>
      </tr>
  </tbody>
</table>

<% if @post.favorited_by?(current_user) %>
  <p>
    <%= link_to post_favorite_path(@post.id), method: :delete do %>
      ♥<%= @post.favorites.count %>いいね
    <% end %>
  </p>
  <% else %>
  <p>
    <%= link_to post_favorite_path(@post.id), method: :post do %>
      ♡<%= @post.favorites.count %>いいね
    <% end %>
  </p>
<% end %>

<div>
  <p><%= @post.post_comments.count %>コメント</p>
  <% @post.post_comments.each do |post_comment| %>
    <%= post_comment.user.name %>
    <%= post_comment.comment %>
    <%= post_comment.created_at.strftime('%Y/%m/%d') %>
    <% if post_comment.user == current_user %>
      <%= link_to "削除", post_post_comment_path(post_comment.post.id, post_comment.id), method: :delete %>
    <% end %>
  <% end %>
</div>

<div>
  <%= form_with model: [@post, @post_comment] do |f| %>
    <%= f.text_area :comment, rows:'5', placeholder: "コメントを入力" %>
    <%= f.submit "投稿する" %>
  <% end %>
</div>